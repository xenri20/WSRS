@model WSRS_Formators.Models.StudentRecordViewModel
@{
    ViewData["Title"] = "Student Records";
}

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Student Violation Reports</h2>
        </div>
</div>

<div class="container text-center mt-4">
        <img src="~/images/logo.png" alt="DLSU-D Logo" style="width: 100px;" />
    <h3><strong>Greetings, Mr. Figueroa!</strong></h3>
    <p>Search Student Record to check record.</p>

   <form method="post" asp-action="WSRSEmp" class="d-flex justify-content-center mb-3">

        <input type="text" name="studentNumber" class="form-control rounded-pill w-50" placeholder="Enter Student Number" required />
        <button type="submit" class="btn btn-dark ms-2"><i class="bi bi-search"></i> Search</button>
    </form>

        @if (ViewBag.NotFound == true)
        {
            <div class="text-center text-danger fw-bold">NO RECORDS FOUND!</div>
        }
        else if (Model?.Student != null)
        {
            <div class="text-center">
                <h5>@Model.Student.FirstName @Model.Student.LastName</h5>
                <p>@Model.Student.StudentNumber</p>
            </div>

            <h6>Previous Records:</h6>

            <!-- GENERAL VIOLATIONS -->
            @if (Model.ReportsEncoded.Any())
            {
                <h6>General Violations</h6>
                <table class="table table-bordered text-center">
                    <thead class="table-dark">
                        <tr>
                            <th>Commission Date</th>
                            <th>Nature of Offense</th>
                            <th>Classification</th>
                            <th>Sanction</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var report in Model.ReportsEncoded)
                        {
                            <tr>
                                <td>@report.CommissionDate.ToShortDateString()</td>
                                <td>@report.Offense?.Nature</td>
                                <td>@report.Offense?.Classification</td>
                                <td>@report.Sanction</td>
                                <td>@report.StatusOfSanction</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }

            <!-- TRAFFIC VIOLATIONS -->
            @if (Model.TrafficReportsEncoded.Any())
            {
                <h6>Traffic Violations</h6>
                <table class="table table-bordered text-center">
                    <thead class="table-secondary">
                        <tr>
                            <th>Commission Date</th>
                            <th>Nature of Offense</th>
                            <th>Classification</th>
                            <th>Plate Number</th>
                            <th>Place</th>
                            <th>Remarks</th>
                            <th>Sanction</th>
                            <th>Date Paid</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var traffic in Model.TrafficReportsEncoded)
                        {
                            <tr>
                                <td>@traffic.CommissionDate.ToShortDateString()</td>
                                <td>@traffic.Offense?.Nature</td>
                                <td>@traffic.Offense?.Classification</td>
                                <td>@traffic.PlateNumber</td>
                                <td>@traffic.Place</td>
                                <td>@traffic.Remarks</td>
                                <td>@traffic.Offense?</td>
                                <td>@traffic.DatePaid?.ToShortDateString() ?? "Unpaid"</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }

        <a asp-action="CreateReport" asp-route-studentNumber="@Model.Student.StudentNumber" asp-route-studentName="@Model.Student.FirstName @Model.Student.LastName" class="btn btn-success">Create Report</a>

        }
    @if (ViewBag.NotFound == true)
    {
        <div>
            <a asp-action="CreateReport" class="btn btn-success">+ Create Violation</a>
        </div>
    }


    <footer class="mt-5">
        <p>
            <small>Student Welfare and Formation Office Record System</small><br />
            <small>Copyright © 2015 De La Salle University – Dasmariñas</small>
        </p>
    </footer>
</div>
